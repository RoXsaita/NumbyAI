<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Finance Dashboard Test</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', system-ui, sans-serif;
      background: #f8fafc;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      padding: 10px 20px;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .theme-toggle:hover {
      background: #f8fafc;
    }
    
    #dashboard-root {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
      overflow: hidden;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
  
  <div class="container">
    <div id="dashboard-root"></div>
  </div>

  <script type="module">
    // Mock OpenAI global object
    window.openai = {
      theme: 'light',
      displayMode: 'inline',
      toolOutput: {
        kind: 'dashboard',
        generated_at: '2024-07-25T15:10:00Z',
        version: '2.0.0',
        statement: {
          id: 'stmt_pivot_mock',
          month: 'Mayâ€“July 2024',
          bank: 'Chase Bank',
          currency: 'USD',
        },
        transactions: [
          {
            id: 'txn_mock_001',
            transaction_date: '2024-07-15',
            description: 'Salary - Acme Corp',
            amount: 4000,
            currency: 'USD',
            category: 'Income',
          },
          {
            id: 'txn_mock_002',
            transaction_date: '2024-07-04',
            description: 'Rent payment',
            amount: -1800,
            currency: 'USD',
            category: 'Housing',
          },
          {
            id: 'txn_mock_003',
            transaction_date: '2024-07-09',
            description: 'Groceries',
            amount: -210,
            currency: 'USD',
            category: 'Food',
          },
        ],
        metrics: {
          inflows: 12800,
          outflows: 9440,
          internal_transfers: 1500,
          net_cash: 1860,
          budget_coverage_pct: 104.5,
          latest_month: '2024-07',
          previous_month: '2024-06',
          month_over_month_delta: -270,
          month_over_month_pct: -4.1,
          segments: [
            { name: 'inflows', actual: 12800, budget: 12600, variance: 200, variance_pct: 1.6 },
            { name: 'outflows', actual: 9440, budget: 9030, variance: 410, variance_pct: 4.5 },
            { name: 'internal_transfers', actual: 1500, budget: 1440, variance: 60, variance_pct: 4.2 },
          ],
          top_variances: [
            { category: 'Housing', actual: -5400, budget: -5100, variance: -300, variance_pct: 5.9, direction: 'over' },
            { category: 'Income', actual: 12800, budget: 12600, variance: 200, variance_pct: 1.6, direction: 'over' },
            { category: 'Food', actual: -1880, budget: -1800, variance: -80, variance_pct: 4.4, direction: 'over' },
          ],
        },
        pivot: {
          categories: ['Income', 'Housing', 'Food', 'Transportation', 'Lifestyle', 'Savings'],
          months: ['2024-05', '2024-06', '2024-07'],
          actuals: [
            [4500, 4300, 4000],
            [-1800, -1800, -1800],
            [-650, -620, -610],
            [-280, -300, -310],
            [-400, -450, -420],
            [-500, -500, -500],
          ],
          budgets: [
            [4200, 4200, 4200],
            [-1700, -1700, -1700],
            [-600, -600, -600],
            [-300, -300, -300],
            [-410, -410, -410],
            [-480, -480, -480],
          ],
          transaction_counts: [
            [2, 2, 2],
            [1, 1, 1],
            [6, 6, 6],
            [4, 4, 4],
            [3, 3, 3],
            [3, 3, 3],
          ],
          category_totals: {
            Income: 12800,
            Housing: -5400,
            Food: -1880,
            Transportation: -890,
            Lifestyle: -1270,
            Savings: -1500,
          },
          category_budget_totals: {
            Income: 12600,
            Housing: -5100,
            Food: -1800,
            Transportation: -900,
            Lifestyle: -1230,
            Savings: -1440,
          },
          month_totals: {
            '2024-05': 870,
            '2024-06': 630,
            '2024-07': 360,
          },
          month_budget_totals: {
            '2024-05': 710,
            '2024-06': 710,
            '2024-07': 710,
          },
          category_shares: {
            Income: 0,
            Housing: 49.4,
            Food: 17.2,
            Transportation: 8.1,
            Lifestyle: 11.6,
            Savings: 13.7,
          },
          currency: 'USD',
        },
        currency: 'USD',
        banks: ['Chase', 'Amex'],
        coverage: {
          start: '2024-05-01',
          end: '2024-07-31',
        },
        summary_count: 12,
      },
      toolResponseMetadata: null,
      widgetState: null,
    };

    // Theme toggle function
    window.toggleTheme = function() {
      window.openai.theme = window.openai.theme === 'light' ? 'dark' : 'light';
      document.body.style.background = window.openai.theme === 'light' ? '#f8fafc' : '#0f172a';
      
      // Dispatch event to notify widget
      window.dispatchEvent(new CustomEvent('openai:set_globals', {
        detail: { globals: { theme: window.openai.theme } }
      }));
    };

    // Load the dashboard widget
    import('../web/dist/dashboard-ZNK5O637.js');
  </script>
</body>
</html>

